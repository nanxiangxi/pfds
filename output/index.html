<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>MciLm_apiæ–‡æ¡£</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="assets/css/main.css">
</head>
<body>

<div class="header">
  <div class="header-left">
    <div class="logo">MciLm_apiæ–‡æ¡£</div>
  </div>

  <!-- æ‰‹æœºç«¯æ±‰å ¡èœå• -->
  <button class="hamburger" aria-label="Toggle Menu">
    <span></span>
    <span></span>
    <span></span>
  </button>
  <script>
    // ç§»åŠ¨ç«¯ä¾§è¾¹æ æ§åˆ¶
    document.addEventListener('DOMContentLoaded', function () {
      const hamburger = document.querySelector('.hamburger');
      const nav = document.querySelector('.nav');
      const overlay = document.getElementById('mobileOverlay');
      const container = document.querySelector('.container');

      if (!hamburger || !nav || !overlay || !container) return;

      hamburger.addEventListener('click', function () {
        this.classList.toggle('active');
        nav.classList.toggle('show');
        container.classList.toggle('show-nav');
        overlay.style.display = nav.classList.contains('show') ? 'block' : 'none';
      });

      overlay.addEventListener('click', function () {
        hamburger.classList.remove('active');
        nav.classList.remove('show');
        container.classList.remove('show-nav');
        this.style.display = 'none';
      });
    });
  </script>
  <!-- æ‰‹æœºç«¯é®ç½©å±‚ -->
  <div class="overlay" id="mobileOverlay"></div>


  <div class="header-right">
    <div class="search-container" id="mobileSearchContainer">
      <input type="text" id="searchInput" placeholder="è¾“å…¥å…³é”®è¯è¿›è¡Œæœç´¢..." />
      <button onclick="openSearchModal()">æœç´¢</button>
    </div>
    <div class="nav-links" id="mobileNavLinks">
            <a href="https://pfds.shlm.top">å®˜ç½‘</a>

    </div>
  </div>
</div>

<div class="container">
  <div class="nav">
    <ul>
    <li><a href="#" onclick="showPage('home')" id="nav-home" class="active">å¿«é€Ÿå¼€å§‹</a></li>
</ul>
  </div>

  <div class="content-area">
    <div class="content-main">
      <div id="home" class="page-content active view-scope-home">
<h1>å­˜æ¡£æ“ä½œæ¥å£</h1>

<div class="card">
    <p><strong>å­˜æ¡£æ“ä½œæ¥å£</strong> æä¾›å¯¹ Minecraft æœåŠ¡å™¨çš„å­˜æ¡£ä¿¡æ¯è·å–ã€å¯åŠ¨å’Œåˆ é™¤ç­‰æ“ä½œï¼Œé€šè¿‡ HTTP POST è¯·æ±‚å®Œæˆï¼Œå¹¶æ”¯æŒä¼ ç»Ÿ form è¡¨å•æäº¤ã€‚</p>
</div>

<hr class="side-nav-divider">

<div class="markdown-output"></div>
<h2><span class="green-pound">#</span> æ¥å£æ¦‚è§ˆ</h2>
<table class="api-table">
    <thead>
    <tr>
        <th>å­—æ®µ</th>
        <th>è¯´æ˜</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>æ¥å£åœ°å€</td>
        <td><code>/archive</code></td>
    </tr>
    <tr>
        <td>è¯·æ±‚æ–¹å¼</td>
        <td><code>POST</code></td>
    </tr>
    <tr>
        <td>èº«ä»½éªŒè¯</td>
        <td>æ˜¯</td>
    </tr>
    <tr>
        <td>ä½œç”¨è¯´æ˜</td>
        <td>ç”¨äºå®¢æˆ·ç«¯æ‰§è¡Œå­˜æ¡£ä¿¡æ¯è·å–ã€å¯åŠ¨æˆ–åˆ é™¤ç­‰æ“ä½œã€‚</td>
    </tr>
    </tbody>
</table>

<hr class="side-nav-divider">

<h2><span class="green-pound">#</span> æ”¯æŒçš„æ“ä½œï¼ˆactionï¼‰</h2>
<table class="api-table">
    <thead>
    <tr>
        <th>æ“ä½œç±»å‹ (action)</th>
        <th>è¯´æ˜</th>
        <th>æ˜¯å¦éœ€è¦ data å‚æ•°</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td><code>get</code></td>
        <td>è·å–å­˜æ¡£åˆ—è¡¨ä¿¡æ¯</td>
        <td>å¦</td>
    </tr>
    <tr>
        <td><code>start</code></td>
        <td>å¯åŠ¨æŒ‡å®šå­˜æ¡£çš„æœåŠ¡å™¨</td>
        <td>æ˜¯</td>
    </tr>
    <tr>
        <td><code>del</code></td>
        <td>åˆ é™¤æŒ‡å®šå­˜æ¡£åŠå…¶ç›¸å…³èµ„æº</td>
        <td>æ˜¯</td>
    </tr>
    </tbody>
</table>

<hr class="side-nav-divider">

<h2><span class="green-pound">#</span> è¯·æ±‚å‚æ•°</h2>
<p>æ‰€æœ‰å‚æ•°ä»¥è¡¨å•å½¢å¼æäº¤ï¼š</p>
<table class="api-table">
    <thead>
    <tr>
        <th>å‚æ•°å</th>
        <th>ç±»å‹</th>
        <th>å¿…å¡«</th>
        <th>è¯´æ˜</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td><code>action</code></td>
        <td>å­—ç¬¦ä¸²</td>
        <td>æ˜¯</td>
        <td>æŒ‡å®šè¦æ‰§è¡Œçš„æ“ä½œç±»å‹ï¼ˆget / start / delï¼‰</td>
    </tr>
    <tr>
        <td><code>data</code></td>
        <td>å­—ç¬¦ä¸²</td>
        <td>å¦</td>
        <td>å½“ action ä¸º start æˆ– del æ—¶ï¼Œå¿…é¡»æä¾›è¯¥å‚æ•°ä½œä¸ºå­˜æ¡£åç§°</td>
    </tr>
    </tbody>
</table>

<hr class="side-nav-divider">

<h2><span class="green-pound">#</span> è¿”å›æ ¼å¼</h2>
<p>è¿”å› JSON æ ¼å¼æ•°æ®ï¼Œç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="json">
{
  "status": "success", // æˆ– error
  "message": "æ“ä½œç»“æœæè¿°",
  "data": { /* å¯é€‰é™„åŠ æ•°æ® */ }
}
</code></pre>

<hr class="side-nav-divider">

<h2><span class="green-pound">#</span> æˆåŠŸå“åº”ç¤ºä¾‹</h2>

<h3>GET æ“ä½œæˆåŠŸ</h3>
<pre><code class="json">
{
  "status": "success",
  "message": "è·å–å­˜æ¡£åˆ—è¡¨ä¿¡æ¯æˆåŠŸ",
  "data": {
    "result": "server1,server2"
  }
}
</code></pre>

<h3>START æ“ä½œæˆåŠŸ</h3>
<pre><code class="json">
{
  "status": "success",
  "message": "å¯åŠ¨æ“ä½œæˆåŠŸ",
  "data": {
    "data": "server1"
  }
}
</code></pre>

<h3>DEL æ“ä½œæˆåŠŸ</h3>
<pre><code class="json">
{
  "status": "success",
  "message": "åˆ é™¤æˆåŠŸ",
  "data": "server1"
}
</code></pre>

<h3>é”™è¯¯å“åº”ç¤ºä¾‹</h3>
<pre><code class="json">
{
  "status": "error",
  "message": "ç¼ºå°‘å¿…è¦çš„å‚æ•° 'action'"
}
</code></pre>

<pre><code class="json">
{
  "status": "error",
  "message": "åˆ é™¤æ“ä½œå¤±è´¥: remove server1: no such file or directory"
}
</code></pre>

<hr class="side-nav-divider">

<h2><span class="green-pound">#</span> ä½¿ç”¨æ–¹æ³•ï¼ˆå« Token è®¤è¯ï¼‰</h2>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ JavaScript ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•é€šè¿‡ Fetch API ç™»å½• â†’ è·å– Token â†’ æ‰§è¡Œå­˜æ¡£æ“ä½œï¼š</p>
<pre><code class="javascript">
const loginUrl = "http://127.0.0.1:309/login";
const archiveUrl = "http://127.0.0.1:309/archive";

// Step 1: ç™»å½•å¹¶è·å– Token
async function loginAndGetToken(password) {
  const formData = new URLSearchParams();
  formData.append("password", password);

  const res = await fetch(loginUrl, {
    method: "POST",
    headers: {
      "Content-Type": "application/x-www-form-urlencoded"
    },
    body: formData.toString()
  });

  const data = await res.json();

  if (!res.ok || !data.data?.token) {
    throw new Error("âŒ ç™»å½•å¤±è´¥ï¼š" + (data.message || "æœªçŸ¥é”™è¯¯"));
  }

  console.log("âœ… ç™»å½•æˆåŠŸï¼ŒToken å·²è·å–");
  return data.data.token;
}

// Step 2: å‘é€å­˜æ¡£æ“ä½œè¯·æ±‚
async function sendArchiveCommand(token, action, data = "") {
  const formData = new URLSearchParams();
  formData.append("action", action);
  if (data) formData.append("data", data);

  const res = await fetch(archiveUrl, {
    method: "POST",
    headers: {
      "Authorization": `Bearer ${token}`,
      "Content-Type": "application/x-www-form-urlencoded"
    },
    body: formData.toString()
  });

  return await res.json();
}

// ç¤ºä¾‹è°ƒç”¨
(async () => {
  try {
    const token = await loginAndGetToken("your_password");

    // è·å–å­˜æ¡£åˆ—è¡¨
    const getRes = await sendArchiveCommand(token, "get");
    console.log("è·å–å­˜æ¡£åˆ—è¡¨ä¿¡æ¯:", getRes);

    // å¯åŠ¨æœåŠ¡å™¨
    const startRes = await sendArchiveCommand(token, "start", "server1");
    console.log("å¯åŠ¨å“åº”:", startRes);

    // åˆ é™¤æœåŠ¡å™¨
    const delRes = await sendArchiveCommand(token, "del", "server2");
    console.log("åˆ é™¤å“åº”:", delRes);

  } catch (err) {
    console.error(err);
  }
})();
</code><span class="language-label">javascript</span></pre>
</div>


    </div>
    <div class="content-nav">
      <ul id="contentNavList"></ul>
    </div>
  </div>
</div>

<div class="modal-overlay" id="searchModal">
  <div class="modal">
    <div id="modalContent"></div>
  </div>
</div>

<!-- å¼•å…¥ Highlight.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>

<script type="module" src="assets/js/modules.js"></script>


<!-- DEV_ONLY_START -->
<!-- çƒ­é‡è½½å®¢æˆ·ç«¯ -->
<script src="/socket.io/socket.io.js"></script>
<script>
  const socket = io();
  socket.on('reload', function () {
    console.log('ğŸ” æ£€æµ‹åˆ°æ–‡ä»¶æ›´æ–°ï¼Œé¡µé¢å³å°†åˆ·æ–°...');
    location.reload();
  });
</script>
<!-- DEV_ONLY_END -->
</body>
</html>
